import json

class ReportGenerator:
    def __init__(self, scan_results):
        self.scan_results = scan_results

    def generate_report(self, output_file):
        if output_file.endswith('.json'):
            with open(output_file, "w") as f:
                json.dump(self.scan_results, f, indent=4)
            print(f"Report saved to {output_file}")
        elif output_file.endswith('.txt'):
            with open(output_file, "w") as f:
                for url, vulns in self.scan_results.items():
                    f.write(f"{url}\n")
                    for vuln in vulns:
                        f.write(f"  - {vuln}\n")
                    f.write("\n")
            print(f"Report saved to {output_file}")
        else:
            raise ValueError("Unsupported format. Please choose 'txt' or 'json'.")